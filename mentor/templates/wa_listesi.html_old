<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>

body {
    font-family: system-ui;
    background: #fafafa;
}

.container {
    display: flex;
    gap: 20px;
    padding: 20px;
    overflow-x: auto;
}

.abi-column {
    min-width: 260px;
    background: #eee;
    border-radius: 12px;
    padding: 10px;
}

.abi-title {
    text-align: center;
    font-weight: 700;
    margin-bottom: 10px;
}

.talebe {
    background: white;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 8px;
    cursor: grab;
    box-shadow: 0 2px 5px rgba(0,0,0,.15);
    transition:.2s;
}

.talebe:active {
    opacity:.5;
}

.gold { border-left:5px solid gold }
.altin { border-left:5px solid orange }
.bronz { border-left:5px solid brown }

</style>
</head>

<body>

<div class="container">

{% for abi, talebeler in gruplar.items %}

<div class="abi-column"
     data-abi="{{ abi }}"
     ondrop="drop(event)"
     ondragover="allowDrop(event)">

    <div class="abi-title">{{ abi }}</div>

    {% for t in talebeler %}
    <div class="talebe {{ t.lig }}"
         draggable="true"
         ondragstart="drag(event)"
         data-id="{{ t.id }}">

        <strong>{{ t.isim }}</strong><br>
        <small>{{ t.lig|upper }}</small><br>
        <code>{{ t.wa_id }}</code>

    </div>
    {% endfor %}

</div>

{% endfor %}

</div>

<script>

let draggedId=null;

function drag(e){
    draggedId=e.target.dataset.id;
}

function allowDrop(e){
    e.preventDefault();
}

function drop(e){
    e.preventDefault();

    const abi=e.currentTarget.dataset.abi;
    const el=document.querySelector(`[data-id="${draggedId}"]`);
    e.currentTarget.appendChild(el);

    fetch("/talebe-tasi/",{
        method:"POST",
        headers:{
            "X-CSRFToken":"{{ csrf_token }}",
            "Content-Type":"application/json"
        },
        body:JSON.stringify({
            talebe_id:draggedId,
            yeni_abi:abi
        })
    });

}

</script>

</body>
</html>
